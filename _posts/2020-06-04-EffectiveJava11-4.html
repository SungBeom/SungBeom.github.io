---
layout: post
title: "[Effective Java]readObject 메소드는 방어적으로 작성하라"
subtitle: "직렬화, 네 번째 아이템"
date: 2020-06-04 23:59:00
background: '/img/posts/EffectiveJava.jpg'
---

<h2 class="section-heading"></h2>

<p style="font-family: NanumGothic">
</p>

<br>

<h2 class="section-heading" style="color: red">핵심 정리</h2>

<p style="font-family: NanumGothic">
    readObject 메소드를 작성할 때는 언제나 public 생성자를 작성하는 자세로 임해야 한다.
    readObject는 어떤 바이트 스트림이 넘어오더라도 유효한 인스턴스를 만들어내야 한다.
    바이트 스트림이 진짜 직렬화된 인스턴스라고 가정해서는 안 된다.
    이번 아이템에서는 기본 직렬화 형태를 사용한 클래스를 예로 들었지만 커스텀 직렬화를 사용하더라도 모든 문제가 그대로 발생할 수 있다.
    이어서 안전한 readObject 메소드를 작성하는 지침을 요약해보았다.
    <br><br>
    private이어야 하는 객체 참조 필드는 각 필드가 가리키는 객체를 방어적으로 복사하라.
    불변 클래스 내의 가변 요소가 여기 속한다.
    <br>
    모든 불변식을 검사하여 어긋나는 게 발견되면 InvalidObjectException을 던진다.
    방어적 복사 다음에는 반드시 불변식 검사가 뒤따라야 한다.
    <br>
    역직렬화 후 객체 그래프 전체의 유효성을 검사해야 한다면 ObjectInputValidation 인터페이스를 사용하라.
    <br>
    직접적이든 간접적이든, 재정의할 수 있는 메소드는 호출하지 말자.
</p>
